<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:views="clr-namespace:uchat_client.Views"
             xmlns:viewModels="clr-namespace:uchat_client.ViewModels"
             xmlns:converters="clr-namespace:uchat_client.Converters"
             x:Class="uchat_client.Views.ContactFriendListView"
             x:DataType="viewModels:ContactFriendListViewModel"
             Background="#364D70">

    <UserControl.Resources>
        <converters:StringNotEmptyConverter x:Key="StringNotEmptyConverter"/>

        <StreamGeometry x:Key="SearchIcon">
            M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59
            14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41
            11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12
            7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z
        </StreamGeometry>

        <StreamGeometry x:Key="ProfileIcon">
            M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,
            1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z
        </StreamGeometry>
    </UserControl.Resources>

    <Grid ColumnDefinitions="Auto,*">

        <!-- SIDEBAR -->
        <views:SidebarView Grid.Column="0"
                           DataContext="{Binding SidebarViewModel}" />

        <!-- MAIN CONTENT - TWO COLUMN LAYOUT -->
        <Grid Grid.Column="1" ColumnDefinitions="*,*" Margin="16">

            <!-- LEFT COLUMN - CONTACTS -->
            <Border Grid.Column="0"
                    Background="#4A6491"
                    CornerRadius="12,0,0,12"
                    Padding="20"
                    Margin="0,0,8,0">
                <Grid RowDefinitions="Auto,Auto,*">

                    <!-- Header -->
                    <TextBlock Grid.Row="0"
                               Text="Contacts"
                               FontSize="24"
                               FontWeight="Bold"
                               Foreground="White"
                               Margin="0,0,0,16"/>

                    <!-- Search Bar -->
                    <Border Grid.Row="1"
                            Background="White"
                            CornerRadius="20"
                            Height="40"
                            Margin="0,0,0,16">
                        <Grid ColumnDefinitions="Auto,*">
                            <Path Grid.Column="0"
                                  Data="{StaticResource SearchIcon}"
                                  Fill="#364D70"
                                  Width="20"
                                  Height="20"
                                  Margin="12,0,8,0"
                                  VerticalAlignment="Center"
                                  Stretch="Uniform"/>

                            <TextBox Grid.Column="1"
                                     Text="{Binding ContactSearchText}"
                                     Background="Transparent"
                                     BorderThickness="0"
                                     Foreground="#364D70"
                                     FontSize="14"
                                     VerticalContentAlignment="Center"
                                     Watermark="Search contacts"
                                     Padding="0,0,12,0">
                                <TextBox.Styles>
                                    <Style Selector="TextBox:focus /template/ Border#PART_BorderElement">
                                        <Setter Property="Background" Value="Transparent"/>
                                        <Setter Property="BorderThickness" Value="0"/>
                                    </Style>
                                    <Style Selector="TextBox:pointerover /template/ Border#PART_BorderElement">
                                        <Setter Property="Background" Value="Transparent"/>
                                    </Style>
                                </TextBox.Styles>
                            </TextBox>
                        </Grid>
                    </Border>

                    <!-- Contacts List with LEFT-SIDE Scrollbar -->
                    <ScrollViewer Grid.Row="2"
                                  VerticalScrollBarVisibility="Auto"
                                  HorizontalScrollBarVisibility="Disabled">
                        <ScrollViewer.Styles>
                            <!-- Custom scrollbar on LEFT side -->
                            <Style Selector="ScrollViewer /template/ ScrollBar:vertical">
                                <Setter Property="HorizontalAlignment" Value="Left"/>
                                <Setter Property="Width" Value="8"/>
                                <Setter Property="MinWidth" Value="8"/>
                                <Setter Property="Background" Value="Transparent"/>
                                <Setter Property="Margin" Value="0,0,8,0"/>
                            </Style>
                            <Style Selector="ScrollBar /template/ RepeatButton">
                                <Setter Property="IsVisible" Value="False"/>
                            </Style>
                            <Style Selector="ScrollBar /template/ Thumb">
                                <Setter Property="Background" Value="#99FFFFFF"/>
                                <Setter Property="CornerRadius" Value="4"/>
                                <Setter Property="BorderThickness" Value="0"/>
                            </Style>
                            <Style Selector="ScrollBar /template/ Thumb:pointerover">
                                <Setter Property="Background" Value="#B2FFFFFF"/>
                            </Style>
                            <Style Selector="ScrollBar /template/ Thumb:pressed">
                                <Setter Property="Background" Value="#CCFFFFFF"/>
                            </Style>
                        </ScrollViewer.Styles>

                        <ItemsControl ItemsSource="{Binding FilteredContacts}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Button Command="{Binding $parent[ItemsControl].((viewModels:ContactFriendListViewModel)DataContext).OpenContactChatCommand}"
                                            CommandParameter="{Binding}"
                                            Background="Transparent"
                                            BorderThickness="0"
                                            HorizontalContentAlignment="Stretch"
                                            Margin="0,0,0,8">
                                        <Button.Styles>
                                            <Style Selector="Button:pointerover">
                                                <Setter Property="Background" Value="#33FFFFFF"/>
                                            </Style>
                                        </Button.Styles>

                                        <Border Background="#5A7AA1"
                                                CornerRadius="8"
                                                Padding="12">
                                            <Grid ColumnDefinitions="Auto,*">
                                                <Border Grid.Column="0"
                                                        Width="40"
                                                        Height="40"
                                                        CornerRadius="20"
                                                        Background="White"
                                                        Margin="0,0,12,0">
                                                    <Path Data="{StaticResource ProfileIcon}"
                                                          Fill="#364D70"
                                                          Width="24"
                                                          Height="24"
                                                          Stretch="Uniform"
                                                          HorizontalAlignment="Center"
                                                          VerticalAlignment="Center"/>
                                                </Border>

                                                <TextBlock Grid.Column="1"
                                                           Text="{Binding Username}"
                                                           Foreground="White"
                                                           FontSize="16"
                                                           VerticalAlignment="Center"/>
                                            </Grid>
                                        </Border>
                                    </Button>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                </Grid>
            </Border>

            <!-- RIGHT COLUMN - FRIENDS -->
            <Border Grid.Column="1"
                    Background="#4A6491"
                    CornerRadius="0,12,12,0"
                    Padding="20"
                    Margin="8,0,0,0">
                <Grid RowDefinitions="Auto,Auto,*">

                    <!-- Header -->
                    <TextBlock Grid.Row="0"
                               Text="Friends"
                               FontSize="24"
                               FontWeight="Bold"
                               Foreground="White"
                               Margin="0,0,0,16"/>

                    <!-- Search Bar -->
                    <Border Grid.Row="1"
                            Background="White"
                            CornerRadius="20"
                            Height="40"
                            Margin="0,0,0,16">
                        <Grid ColumnDefinitions="Auto,*">
                            <Path Grid.Column="0"
                                  Data="{StaticResource SearchIcon}"
                                  Fill="#364D70"
                                  Width="20"
                                  Height="20"
                                  Margin="12,0,8,0"
                                  VerticalAlignment="Center"
                                  Stretch="Uniform"/>

                            <TextBox Grid.Column="1"
                                     Text="{Binding FriendSearchText}"
                                     Background="Transparent"
                                     BorderThickness="0"
                                     Foreground="#364D70"
                                     FontSize="14"
                                     VerticalContentAlignment="Center"
                                     Watermark="Search friends"
                                     Padding="0,0,12,0">
                                <TextBox.Styles>
                                    <Style Selector="TextBox:focus /template/ Border#PART_BorderElement">
                                        <Setter Property="Background" Value="Transparent"/>
                                        <Setter Property="BorderThickness" Value="0"/>
                                    </Style>
                                    <Style Selector="TextBox:pointerover /template/ Border#PART_BorderElement">
                                        <Setter Property="Background" Value="Transparent"/>
                                    </Style>
                                </TextBox.Styles>
                            </TextBox>
                        </Grid>
                    </Border>

                    <!-- Friends List with RIGHT-SIDE Scrollbar -->
                    <ScrollViewer Grid.Row="2"
                                  VerticalScrollBarVisibility="Auto"
                                  HorizontalScrollBarVisibility="Disabled">
                        <ScrollViewer.Styles>
                            <!-- Custom scrollbar on RIGHT side -->
                            <Style Selector="ScrollViewer /template/ ScrollBar:vertical">
                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                <Setter Property="Width" Value="8"/>
                                <Setter Property="MinWidth" Value="8"/>
                                <Setter Property="Background" Value="Transparent"/>
                                <Setter Property="Margin" Value="8,0,0,0"/>
                            </Style>
                            <Style Selector="ScrollBar /template/ RepeatButton">
                                <Setter Property="IsVisible" Value="False"/>
                            </Style>
                            <Style Selector="ScrollBar /template/ Thumb">
                                <Setter Property="Background" Value="#99FFFFFF"/>
                                <Setter Property="CornerRadius" Value="4"/>
                                <Setter Property="BorderThickness" Value="0"/>
                            </Style>
                            <Style Selector="ScrollBar /template/ Thumb:pointerover">
                                <Setter Property="Background" Value="#B2FFFFFF"/>
                            </Style>
                            <Style Selector="ScrollBar /template/ Thumb:pressed">
                                <Setter Property="Background" Value="#CCFFFFFF"/>
                            </Style>
                        </ScrollViewer.Styles>

                        <ItemsControl ItemsSource="{Binding FilteredFriends}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Button Command="{Binding $parent[ItemsControl].((viewModels:ContactFriendListViewModel)DataContext).OpenFriendChatCommand}"
                                            CommandParameter="{Binding}"
                                            Background="Transparent"
                                            BorderThickness="0"
                                            HorizontalContentAlignment="Stretch"
                                            Margin="0,0,0,8">
                                        <Button.Styles>
                                            <Style Selector="Button:pointerover">
                                                <Setter Property="Background" Value="#33FFFFFF"/>
                                            </Style>
                                        </Button.Styles>

                                        <Border Background="#5A7AA1"
                                                CornerRadius="8"
                                                Padding="12">
                                            <Grid ColumnDefinitions="Auto,*">
                                                <Border Grid.Column="0"
                                                        Width="40"
                                                        Height="40"
                                                        CornerRadius="20"
                                                        Background="White"
                                                        Margin="0,0,12,0">
                                                    <Path Data="{StaticResource ProfileIcon}"
                                                          Fill="#364D70"
                                                          Width="24"
                                                          Height="24"
                                                          Stretch="Uniform"
                                                          HorizontalAlignment="Center"
                                                          VerticalAlignment="Center"/>
                                                </Border>

                                                <TextBlock Grid.Column="1"
                                                           Text="{Binding Username}"
                                                           Foreground="White"
                                                           FontSize="16"
                                                           VerticalAlignment="Center"/>
                                            </Grid>
                                        </Border>
                                    </Button>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                </Grid>
            </Border>
        </Grid>
    </Grid>
</UserControl>